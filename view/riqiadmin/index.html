<!doctype html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>后台管理系统PHP 表格页面 - </title>
    <meta name="description" content="这是一个 table 页面">
    <meta name="keywords" content="table">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <link rel="icon" type="image/png" href="../assets/i/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/i/app-icon72x72@2x.png">
    <meta name="apple-mobile-web-app-title" content="Amaze UI"/>
    <link rel="stylesheet" href="../assets/css/amazeui.min.css"/>
    <link rel="stylesheet" href="../assets/css/admin.css">

    <link rel="stylesheet" href="../calendar.css">
</head>
<body>
<!--[if lte IE 9]>
<p class="browsehappy">你正在使用<strong>过时</strong>的浏览器，Amaze UI 暂不支持。 请 <a href="http://browsehappy.com/" target="_blank">升级浏览器</a>
    以获得更好的体验！</p>
<![endif]-->

<header class="am-topbar admin-header">
    <div class="am-topbar-brand">
        <strong></strong> <small>管理后台</small>
    </div>

    <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only"
            data-am-collapse="{target: '#topbar-collapse'}"><span class="am-sr-only">导航切换</span> <span
            class="am-icon-bars"></span></button>

</header>

<div class="am-cf admin-main">
    <!-- sidebar start -->
    <div class="admin-sidebar">
        <ul class="am-list admin-sidebar-list">
            <li><a href="/admin"><span class="am-icon-table"></span> 开奖管理</a></li>
            <li><a href="/tukuadmin"><span class="am-icon-pencil-square-o"></span> 预测图库</a></li>
            <li><a href="/jieshaoadmin"><span class="am-icon-pencil-square-o"></span> 彩票介绍</a></li>
            <li><a href="/dongshiadmin"><span class="am-icon-pencil-square-o"></span> 公司董事</a></li>
            <li><a href="/jiangjinadmin"><span class="am-icon-pencil-square-o"></span> 奖金分配</a></li>
            <li style="background: #3bb4f2"><a href="/riqiadmin"><span class="am-icon-pencil-square-o"></span> 投注日期</a></li>
            <li><a href="/tiangandizhiadmin"><span class="am-icon-pencil-square-o"></span> 天支地干</a></li>
        </ul>
    </div>
    <!-- sidebar end -->

    <!-- content start -->
    <div class="admin-content">
        <div class="am-cf am-padding">
            <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">设置开奖日期</strong> / <small>table</small>
            </div>
        </div>

        <div class="am-g">
            <div class="am-u-sm-12">
                <span style="color: red">日期暂不可设! </span>
                <iframe src="/setdate.htm" style="width: 700px;height: 800px"></iframe>
            </div>
        </div>
    </div>
    <!-- content end -->
</div>

<footer>
    <hr>
    <p class="am-padding-left">© 2020 Nomansky public</p>
</footer>

<!--[if lt IE 9]>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="assets/js/polyfill/rem.min.js"></script>
<script src="assets/js/polyfill/respond.min.js"></script>
<script src="assets/js/amazeui.legacy.js"></script>
<![endif]-->

<!--[if (gte IE 9)|!(IE)]><!-->
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/amazeui.min.js"></script>
<!--<![endif]-->
<script src="../assets/js/app.js"></script>
<script type="text/javascript">

    // 关于月份： 在设置时要-1，使用时要+1
    $(function () {

        $('#calendar').calendar({
            ifSwitch: true, // 是否切换月份
            hoverDate: true, // hover是否显示当天信息
            backToday: true // 是否返回当天
        });

    });

    ;
    (function ($, window, document, undefined) {

        var Calendar = function (elem, options) {
            this.$calendar = elem;

            this.defaults = {
                ifSwitch: true,
                hoverDate: false,
                backToday: false
            };

            this.opts = $.extend({}, this.defaults, options);

            // console.log(this.opts);
        };

        Calendar.prototype = {
            showHoverInfo: function (obj) { // hover 时显示当天信息
                var _dateStr = $(obj).attr('data');
                var offset_t = $(obj).offset().top + (this.$calendar_today.height() - $(obj).height()) / 2;
                var offset_l = $(obj).offset().left + $(obj).width();
                var changeStr = _dateStr.substr(0, 4) + '-' + _dateStr.substr(4, 2) + '-' + _dateStr.substring(6);
                var _week = changingStr(changeStr).getDay();
                var _weekStr = '';

                this.$calendar_today.show();

                this.$calendar_today
                    .css({
                        left: offset_l + 30,
                        top: offset_t
                    })
                    .stop()
                    .animate({
                        left: offset_l + 16,
                        top: offset_t,
                        opacity: 1
                    });

                switch (_week) {
                    case 0:
                        _weekStr = '星期日';
                        break;
                    case 1:
                        _weekStr = '星期一';
                        break;
                    case 2:
                        _weekStr = '星期二';
                        break;
                    case 3:
                        _weekStr = '星期三';
                        break;
                    case 4:
                        _weekStr = '星期四';
                        break;
                    case 5:
                        _weekStr = '星期五';
                        break;
                    case 6:
                        _weekStr = '星期六';
                        break;
                }

                this.$calendarToday_date.text(changeStr);
                this.$calendarToday_week.text(_weekStr);
            },

            showCalendar: function () { // 输入数据并显示
                var self = this;
                var year = dateObj.getDate().getFullYear();
                var month = dateObj.getDate().getMonth() + 1;
                var dateStr = returnDateStr(dateObj.getDate());
                var firstDay = new Date(year, month - 1, 1); // 当前月的第一天

                this.$calendarTitle_text.text(year + '/' + dateStr.substr(4, 2));

                this.$calendarDate_item.each(function (i) {
                    // allDay: 得到当前列表显示的所有天数
                    var allDay = new Date(year, month - 1, i + 1 - firstDay.getDay());
                    var allDay_str = returnDateStr(allDay);

                    $(this).text(allDay.getDate()).attr('data', allDay_str);

                    if (returnDateStr(new Date()) === allDay_str) {
                        $(this).attr('class', 'item item-curDay');
                    } else if (returnDateStr(firstDay).substr(0, 6) === allDay_str.substr(0, 6)) {
                        $(this).attr('class', 'item item-curMonth');
                    } else {
                        $(this).attr('class', 'item');
                    }
                });
            },

            renderDOM: function () { // 渲染DOM
                this.$calendar_title = $('<div class="calendar-title"></div>');
                this.$calendar_week = $('<ul class="calendar-week"></ul>');
                this.$calendar_date = $('<ul class="calendar-date"></ul>');
                this.$calendar_today = $('<div class="calendar-today"></div>');


                var _titleStr = '<a href="#" class="title"></a>' +
                    '<a href="javascript:;" id="backToday">T</a>' +
                    '<div class="arrow">' +
                    '<span class="arrow-prev"><</span>' +
                    '<span class="arrow-next">></span>' +
                    '</div>';
                var _weekStr = '<li class="item">日</li>' +
                    '<li class="item">一</li>' +
                    '<li class="item">二</li>' +
                    '<li class="item">三</li>' +
                    '<li class="item">四</li>' +
                    '<li class="item">五</li>' +
                    '<li class="item">六</li>';
                var _dateStr = '';
                var _dayStr = '<i class="triangle"></i>' +
                    '<p class="date"></p>' +
                    '<p class="week"></p>';

                for (var i = 0; i < 6; i++) {
                    _dateStr += '<li class="item">26</li>' +
                        '<li class="item">26</li>' +
                        '<li class="item">26</li>' +
                        '<li class="item">26</li>' +
                        '<li class="item">26</li>' +
                        '<li class="item">26</li>' +
                        '<li class="item">26</li>';
                }

                this.$calendar_title.html(_titleStr);
                this.$calendar_week.html(_weekStr);
                this.$calendar_date.html(_dateStr);
                this.$calendar_today.html(_dayStr);

                this.$calendar.append(this.$calendar_title, this.$calendar_week, this.$calendar_date, this.$calendar_today);
                this.$calendar.show();
            },

            inital: function () { // 初始化
                var self = this;

                this.renderDOM();

                this.$calendarTitle_text = this.$calendar_title.find('.title');
                this.$backToday = $('#backToday');
                this.$arrow_prev = this.$calendar_title.find('.arrow-prev');
                this.$arrow_next = this.$calendar_title.find('.arrow-next');
                this.$calendarDate_item = this.$calendar_date.find('.item');
                this.$calendarToday_date = this.$calendar_today.find('.date');
                this.$calendarToday_week = this.$calendar_today.find('.week');

                this.showCalendar();

                if (this.opts.ifSwitch) {
                    this.$arrow_prev.bind('click', function () {
                        var _date = dateObj.getDate();

                        dateObj.setDate(new Date(_date.getFullYear(), _date.getMonth() - 1, 1));

                        self.showCalendar();
                    });

                    this.$arrow_next.bind('click', function () {
                        var _date = dateObj.getDate();

                        dateObj.setDate(new Date(_date.getFullYear(), _date.getMonth() + 1, 1));

                        self.showCalendar();
                    });
                }

                if (this.opts.backToday) {
                    this.$backToday.bind('click', function () {
                        if (!self.$calendarDate_item.hasClass('item-curDay')) {
                            dateObj.setDate(new Date());

                            self.showCalendar();
                        }
                    });
                }

                this.$calendarDate_item.hover(function () {
                    self.showHoverInfo($(this));
                }, function () {
                    self.$calendar_today.css({
                        left: 0,
                        top: 0
                    }).hide();
                });
            },

            constructor: Calendar
        };

        $.fn.calendar = function (options) {
            var calendar = new Calendar(this, options);

            return calendar.inital();
        };


        // ========== 使用到的方法 ==========
        var dateObj = (function () {
            var _date = new Date();
            return {
                getDate: function () {
                    return _date;
                },
                setDate: function (date) {
                    _date = date;
                }
            }
        })();
        function returnDateStr(date) { // 日期转字符串
            var year = date.getFullYear();
            var month = date.getMonth() + 1;
            var day = date.getDate();
            month = month < 9 ? ('0' + month) : ('' + month);
            day = day < 9 ? ('0' + day) : ('' + day);
            return year + month + day;
        };
        function changingStr(fDate) { // 字符串转日期
            var fullDate = fDate.split("-");
            return new Date(fullDate[0], fullDate[1] - 1, fullDate[2]);
        };
    })(jQuery, window, document);
</script>

</body>
</html>
